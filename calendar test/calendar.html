<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta charset='utf-8' />
    <script
    src="http://code.jquery.com/jquery-3.4.1.min.js"
    integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
    crossorigin="anonymous"></script>
    <script src="index.js"></script>
    <link rel="stylesheet" href="style_calendar.css">

    <link rel="stylesheet" href="../assets/css/main.css" />
    
  </head>
  <body class="is-preload">
    <!-- Wrapper -->
    <div id="wrapper">

        <!-- Header -->
          <header id="header">
            <a href="index.html" class="logo">Massively</a>
          </header>

          <!-- Nav -->
        <nav id="nav">
            <ul class="links">
              <li><a href="index.html">This is Massively</a></li>
              <li><a href="generic.html">Generic Page</a></li>
              <li class="active"><a href="elements.html">Elements Reference</a></li>
            </ul>
            <ul class="icons">
              <li><a href="#" class="icon fa-twitter"><span class="label">Twitter</span></a></li>
              <li><a href="#" class="icon fa-facebook"><span class="label">Facebook</span></a></li>
              <li><a href="#" class="icon fa-instagram"><span class="label">Instagram</span></a></li>
              <li><a href="#" class="icon fa-github"><span class="label">GitHub</span></a></li>
            </ul>
          </nav>

          <div id="main">           
              <h2>Schedule selector:</h2><br>
              <div id='cal'>
                <h5>Select your schedule by clicking on the calendar, then submit it by clicking on the button at the end of the page.</h5>
                <h5>
                  <div id="day-schedule">
                  </div>
                </h5>
              </div>
              <form>
                <input type="button" value='Submit Your Schedule' id='selectedBtn'>
              </form>
          </div>
    </div>
    <script>
      let str = [];
      (function ($) {
          $("#day-schedule").dayScheduleSelector({
              days: [0, 1, 2, 3, 4, 5, 6],
              interval: 60,
              startTime: '00:00',
              endTime: '23:59',
              stringDays  : ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
          });
          $("#day-schedule").on('selected.artsy.dayScheduleSelector', function (e, selected) 
          {
              var arr = "{";
              for (var i = 0; i < selected.length; i++)
              {
                  arr +='"'+ i +'":';
                  arr+= JSON.stringify(selected[i].dataset);
                  if (i !== selected.length - 1)
                    arr += ","
              }
              arr += "}";
              console.log(arr);
              str.push(arr);
              console.log(str);
          })
          $("#day-schedule").data('artsy.dayScheduleSelector').deserialize(
          {

          });
      })($);

      $('#selectedBtn').on("click",function()
      {
          console.log(str[0]);
          $.ajax({
            type: "POST",
            url: "../server/sendSchedule.php",
            dataType: "json",
            data: {'schedule': JSON.stringify(str)},
            success: function(data, status) {
                console.log("gucci");
            }
            
          });

          //console.log(test);
      });
  </script>
  </body>
</html>